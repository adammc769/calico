#!/usr/bin/env python3
"""Entry point script for switching Calico sessions."""
import sys
import os
from pathlib import Path

# Add parent directory to path
repo_root = Path(__file__).parent.parent
sys.path.insert(0, str(repo_root))

# Load .env file from repository root
env_file = repo_root / '.env'
if env_file.exists():
    try:
        from dotenv import load_dotenv
        load_dotenv(env_file)
    except ImportError:
        # If python-dotenv not installed, manually load basic env vars
        with open(env_file) as f:
            for line in f:
                line = line.strip()
                if line and not line.startswith('#') and '=' in line:
                    key, value = line.split('=', 1)
                    key = key.strip()
                    value = value.strip().strip('"').strip("'")
                    if key and not os.environ.get(key):
                        os.environ[key] = value

from rich.console import Console

console = Console()

def main():
    """Main entry point for session switching."""
    if len(sys.argv) < 2:
        console.print("[red]Error:[/red] ./session requires a session number (1-9)")
        console.print("[dim]Usage: ./session 3[/dim]")
        return 1
    
    session_num = sys.argv[1]
    
    if not session_num.isdigit():
        console.print(f"[red]Error:[/red] '{session_num}' is not a valid session number")
        console.print("[dim]Usage: ./session 3[/dim]")
        return 1
    
    # This is meant to be used within the CLI
    console.print(f"[yellow]Note:[/yellow] Use './session {session_num}' from within the Calico CLI")
    console.print("[dim]Start the CLI with: ./bin/calico[/dim]")
    
    return 0


if __name__ == "__main__":
    sys.exit(main())
